import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,b as e}from"./app-DVXG84Ap.js";const o={},t=e(`<h2 id="组织单元" tabindex="-1"><a class="header-anchor" href="#组织单元"><span>组织单元</span></a></h2><p>创建组织单元OU</p><p>New-ADOrganizationalUnit -Name &quot;ROOT&quot; -Path &quot;DC=MINICONTOSO,DC=COM&quot;</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;ROOT&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;DC=MINICONTOSO,DC=COM&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查询OU</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADOrganizationalUnit</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&#39;Name -like &quot;*ROOT*&quot;&#39;</span> <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span> DistinguishedName<span class="token punctuation">,</span> ObjectClass<span class="token punctuation">,</span> ProtectedFromAccidentalDeletion

Name DistinguishedName             ObjectClass        ProtectedFromAccidentalDeletion
<span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>             <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
ROOT OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com organizationalUnit                            True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">ProtectedFromAccidentalDeletion</p><p>默认情况下，该设置是True，也就是防止被误删除。</p></div><p>创建子OU</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpUser&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpGroup&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpComputer&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;ServiceAccount&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询子OU</p><p>Get-ADOrganizationalUnit -Filter * -SearchBase &#39;OU=ROOT,DC=minicontoso,DC=com&#39; | Select-Object Name, DistinguishedName</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADOrganizationalUnit</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span> <span class="token operator">-</span>SearchBase <span class="token string">&#39;OU=ROOT,DC=minicontoso,DC=com&#39;</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span> DistinguishedName

Name           DistinguishedName                              
<span class="token operator">--</span><span class="token operator">--</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>                              
ROOT           OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com                  
CorpUser       OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com      
CorpGroup      OU=CorpGroup<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com     
CorpComputer   OU=CorpComputer<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com  
ServiceAccount OU=ServiceAccount<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安全组-文件服务器" tabindex="-1"><a class="header-anchor" href="#安全组-文件服务器"><span>安全组（文件服务器）</span></a></h2><p>创建安全组（示例）</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADGroup</span> <span class="token operator">-</span>Name <span class="token string">&quot;FS-HR-Admin&quot;</span> <span class="token operator">-</span>SamAccountName <span class="token string">&quot;FS-HR-Admin&quot;</span> <span class="token operator">-</span>Description <span class="token string">&quot;File Server Department HR RW&quot;</span> <span class="token operator">-</span>GroupCategory <span class="token string">&quot;Security&quot;</span> <span class="token operator">-</span>GroupScope <span class="token string">&quot;Global&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=CorpGroup,OU=ROOT,DC=minicontoso,DC=com&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token variable">$Parameters</span> = @<span class="token punctuation">{</span>
    Name = <span class="token string">&quot;FS-HR-Admin&quot;</span>
    SamAccountName = <span class="token string">&quot;FS-HR-Admin&quot;</span>
    Description = <span class="token string">&quot;File Server Department HR RW&quot;</span>
    GroupCategory = <span class="token string">&quot;Security&quot;</span>
    GroupScope = <span class="token string">&quot;Global&quot;</span>
    Path = <span class="token string">&quot;OU=CorpGroup,OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token punctuation">}</span>

<span class="token function">New-ADGroup</span> @Parameters
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>批量创建安全组</p><p>D:\\MyGroups.csv</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code>GroupName<span class="token punctuation">,</span>GroupDescription
FS-HR-Admin<span class="token punctuation">,</span>File Server Department HR RW
FS-HR<span class="token punctuation">,</span>File Server Department HR R
FS-Finance-Admin<span class="token punctuation">,</span>File Server Department Finance RW
FS-Finance<span class="token punctuation">,</span>File Server Department Finance R
FS-IT-Admin<span class="token punctuation">,</span>File Server Department IT RW
FS-IT<span class="token punctuation">,</span>File Server Department IT R
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过csv文件批量创建安全组</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token variable">$MyCsv</span> = <span class="token string">&quot;D:\\MyGroups.csv&quot;</span>
<span class="token variable">$MyLines</span> = <span class="token function">Import-Csv</span> <span class="token variable">$MyCsv</span>

 <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$MyLine</span> in <span class="token variable">$MyLines</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token variable">$MyGroup</span> = @<span class="token punctuation">{</span>
    Name = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>GroupName
    SamAccountName = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>GroupName
    Description = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>GroupDescription
    GroupCategory = <span class="token string">&quot;Security&quot;</span>
    GroupScope = <span class="token string">&quot;Global&quot;</span>
    Path = <span class="token string">&quot;OU=CorpGroup,OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token punctuation">}</span>

<span class="token function">New-ADGroup</span> @MyGroup

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Get-ADGroup</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADGroup</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span> <span class="token operator">-</span>SearchBase <span class="token string">&quot;OU=CorpGroup,OU=ROOT,DC=minicontoso,DC=com&quot;</span> <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span>SamAccountName<span class="token punctuation">,</span>Description<span class="token punctuation">,</span>GroupCategory<span class="token punctuation">,</span>GroupScope <span class="token punctuation">|</span> <span class="token function">Format-Table</span>

Name             SamAccountName   Description                       GroupCategory GroupScope
<span class="token operator">--</span><span class="token operator">--</span>             <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>                       <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
FS-HR-Admin      FS-HR-Admin      File Server Department HR RW           Security     Global
FS-HR            FS-HR            File Server Department HR R            Security     Global
FS-Finance-Admin FS-Finance-Admin File Server Department Finance RW      Security     Global
FS-Finance       FS-Finance       File Server Department Finance R       Security     Global
FS-IT-Admin      FS-IT-Admin      File Server Department IT RW           Security     Global
FS-IT            FS-IT            File Server Department IT R            Security     Global
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),p=[t];function r(i,l){return a(),s("div",null,p)}const d=n(o,[["render",r],["__file","group.html.vue"]]),m=JSON.parse('{"path":"/adds/group.html","title":"组管理","lang":"zh-CN","frontmatter":{"title":"组管理","icon":"user-group","order":5,"category":["活动目录"],"tag":["活动目录","组管理"],"description":"组织单元 创建组织单元OU New-ADOrganizationalUnit -Name \\"ROOT\\" -Path \\"DC=MINICONTOSO,DC=COM\\" 查询OU ProtectedFromAccidentalDeletion 默认情况下，该设置是True，也就是防止被误删除。 创建子OU 查询子OU Get-ADOrganizational...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/windows/adds/group.html"}],["meta",{"property":"og:site_name","content":"minicontoso"}],["meta",{"property":"og:title","content":"组管理"}],["meta",{"property":"og:description","content":"组织单元 创建组织单元OU New-ADOrganizationalUnit -Name \\"ROOT\\" -Path \\"DC=MINICONTOSO,DC=COM\\" 查询OU ProtectedFromAccidentalDeletion 默认情况下，该设置是True，也就是防止被误删除。 创建子OU 查询子OU Get-ADOrganizational..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"Echo"}],["meta",{"property":"article:tag","content":"活动目录"}],["meta",{"property":"article:tag","content":"组管理"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"组管理\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Echo\\",\\"url\\":\\"https://www.minicontoso.com\\"}]}"]]},"headers":[{"level":2,"title":"组织单元","slug":"组织单元","link":"#组织单元","children":[]},{"level":2,"title":"安全组（文件服务器）","slug":"安全组-文件服务器","link":"#安全组-文件服务器","children":[]}],"git":{},"readingTime":{"minutes":1.72,"words":517},"filePathRelative":"adds/group.md","autoDesc":true}');export{d as comp,m as data};

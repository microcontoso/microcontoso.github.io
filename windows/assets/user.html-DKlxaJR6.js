import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,o as s,b as e}from"./app-DVXG84Ap.js";const t={},o=e(`<h2 id="组织单元" tabindex="-1"><a class="header-anchor" href="#组织单元"><span>组织单元</span></a></h2><p>创建组织单元OU</p><p>New-ADOrganizationalUnit -Name &quot;ROOT&quot; -Path &quot;DC=MINICONTOSO,DC=COM&quot;</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;ROOT&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;DC=MINICONTOSO,DC=COM&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查询OU</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADOrganizationalUnit</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&#39;Name -like &quot;*ROOT*&quot;&#39;</span> <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span> DistinguishedName<span class="token punctuation">,</span> ObjectClass<span class="token punctuation">,</span> ProtectedFromAccidentalDeletion

Name DistinguishedName             ObjectClass        ProtectedFromAccidentalDeletion
<span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>             <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
ROOT OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com organizationalUnit                            True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">ProtectedFromAccidentalDeletion</p><p>默认情况下，该设置是True，也就是防止被误删除。</p></div><p>创建子OU</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpUser&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpGroup&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;CorpComputer&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
<span class="token function">New-ADOrganizationalUnit</span> <span class="token operator">-</span>Name <span class="token string">&quot;ServiceAccount&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=ROOT,DC=minicontoso,DC=com&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询子OU</p><p>Get-ADOrganizationalUnit -Filter * -SearchBase &#39;OU=ROOT,DC=minicontoso,DC=com&#39; | Select-Object Name, DistinguishedName</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADOrganizationalUnit</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span> <span class="token operator">-</span>SearchBase <span class="token string">&#39;OU=ROOT,DC=minicontoso,DC=com&#39;</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span> DistinguishedName

Name           DistinguishedName                              
<span class="token operator">--</span><span class="token operator">--</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>                              
ROOT           OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com                  
CorpUser       OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com      
CorpGroup      OU=CorpGroup<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com     
CorpComputer   OU=CorpComputer<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com  
ServiceAccount OU=ServiceAccount<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="创建用户方式一" tabindex="-1"><a class="header-anchor" href="#创建用户方式一"><span>创建用户方式一</span></a></h2><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">New-ADUser</span> <span class="token operator">-</span>EmployeeID <span class="token string">&quot;100001&quot;</span> <span class="token operator">-</span>Description <span class="token string">&quot;Employee&quot;</span> <span class="token operator">-</span>GivenName <span class="token string">&quot;Hui&quot;</span> <span class="token operator">-</span>Surname <span class="token string">&quot;Gao&quot;</span> <span class="token operator">-</span>Name <span class="token string">&quot;Hui Gao&quot;</span> <span class="token operator">-</span>DisplayName <span class="token string">&quot;Hui Gao&quot;</span> <span class="token operator">-</span>SamAccountName <span class="token string">&quot;Hui.Gao&quot;</span> <span class="token operator">-</span>UserPrincipalName <span class="token string">&quot;Hui.Gao@minicontoso.com&quot;</span> <span class="token operator">-</span>Department <span class="token string">&quot;Executive Team&quot;</span>  <span class="token operator">-</span>Title <span class="token string">&quot;General Manager&quot;</span> <span class="token operator">-</span>Office <span class="token string">&quot;Beijing&quot;</span> <span class="token operator">-</span>Path <span class="token string">&quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot;</span> <span class="token operator">-</span>Enabled <span class="token boolean">$true</span> <span class="token operator">-</span>AccountPassword <span class="token punctuation">(</span><span class="token function">ConvertTo-SecureString</span> <span class="token string">&quot;P@ssW0rD!&quot;</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="创建用户方式二" tabindex="-1"><a class="header-anchor" href="#创建用户方式二"><span>创建用户方式二</span></a></h2><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token variable">$MyUser</span> = @<span class="token punctuation">{</span>

EmployeeID = <span class="token string">&quot;100001&quot;</span>
Description = <span class="token string">&quot;Employee&quot;</span>
GivenName = <span class="token string">&quot;Hui&quot;</span>
Surname = <span class="token string">&quot;Gao&quot;</span>
Name = <span class="token string">&quot;Hui Gao&quot;</span>
DisplayName = <span class="token string">&quot;Hui Gao&quot;</span>
SamAccountName = <span class="token string">&quot;Hui.Gao&quot;</span>
UserPrincipalName = <span class="token string">&quot;Hui.Gao@minicontoso.com&quot;</span>
Department = <span class="token string">&quot;Executive Team&quot;</span>
Title = <span class="token string">&quot;General Manager&quot;</span>
Office = <span class="token string">&quot;Beijing&quot;</span>
Path = <span class="token string">&quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot;</span>
Enabled = <span class="token boolean">$true</span>
AccountPassword = <span class="token punctuation">(</span><span class="token function">ConvertTo-SecureString</span> <span class="token string">&quot;P@ssW0rD!&quot;</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token function">New-ADUser</span> @MyUser
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查询用户" tabindex="-1"><a class="header-anchor" href="#查询用户"><span>查询用户</span></a></h2><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao

DistinguishedName : CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
Enabled           : True
GivenName         : Hui
Name              : Hui Gao
ObjectClass       : user
ObjectGUID        : 3ac7b745-338c-44f2-b8cc-32161b7d1ee2
SamAccountName    : Hui<span class="token punctuation">.</span>Gao
SID               : S-1-5-21-3239104355-2175597371-602079495-1107
Surname           : Gao
UserPrincipalName : Hui<span class="token punctuation">.</span>Gao@minicontoso<span class="token punctuation">.</span>com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询用户所有属性</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token operator">-</span>Properties <span class="token operator">*</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">获取所有属性，同时复制到剪贴板</p><p>Get-ADUser hui.gao -Properties * | clip</p></div><p>筛选属性</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> EmployeeID<span class="token punctuation">,</span> Description<span class="token punctuation">,</span> GivenName<span class="token punctuation">,</span> Surname<span class="token punctuation">,</span> Name<span class="token punctuation">,</span> DisplayName<span class="token punctuation">,</span> SamAccountName<span class="token punctuation">,</span> UserPrincipalName<span class="token punctuation">,</span> Department<span class="token punctuation">,</span> Title<span class="token punctuation">,</span> Office<span class="token punctuation">,</span> DistinguishedName<span class="token punctuation">,</span> Enabled

EmployeeID        : 100001
Description       : Employee
GivenName         : Hui
Surname           : Gao
Name              : Hui Gao
DisplayName       : Hui Gao
SamAccountName    : Hui<span class="token punctuation">.</span>Gao
UserPrincipalName : Hui<span class="token punctuation">.</span>Gao@minicontoso<span class="token punctuation">.</span>com
Department        : Executive Team
Title             : General Manager
Office            : Beijing
DistinguishedName : CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
Enabled           : True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SamAccountName， UserPrincipalName，DistinguishedName，EmailAddress</p><p>在Windows域环境中或者和其他应用系统集成时，这些用户形式经常会用到。</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> SamAccountName<span class="token punctuation">,</span> UserPrincipalName<span class="token punctuation">,</span> DistinguishedName<span class="token punctuation">,</span> EmailAddress <span class="token punctuation">|</span> <span class="token function">Format-List</span>

SamAccountName    : Hui<span class="token punctuation">.</span>Gao
UserPrincipalName : Hui<span class="token punctuation">.</span>Gao@minicontoso<span class="token punctuation">.</span>com
DistinguishedName : CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
EmailAddress      : 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">UserPrincipalName</p><p>UserPrincipalName和邮箱地址形式上很像，但是它们是两个完全不同的概念。</p><p>我们当前还未实施安装Exchange邮箱系统，EmailAddress属性是空的。</p><p>一般情况下，我们尽量保持UserPrincipalName和EmailAddress一致。</p><p>有些和Windows活动目录集成的系统，我们告诉用户使用邮箱地址作为用户名登录，实际上用户名指的是UserPrincipalName。</p></div><h2 id="防止误删除功能" tabindex="-1"><a class="header-anchor" href="#防止误删除功能"><span>防止误删除功能</span></a></h2><p>默认情况下，ProtectedFromAccidentalDeletion是禁用状态</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> SamAccountName<span class="token punctuation">,</span> ProtectedFromAccidentalDeletion

SamAccountName ProtectedFromAccidentalDeletion
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
Hui<span class="token punctuation">.</span>Gao                                  False
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token comment"># 启用ProtectedFromAccidentalDeletion</span>
<span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token punctuation">|</span> <span class="token function">Set-ADObject</span> <span class="token operator">-</span>ProtectedFromAccidentalDeletion <span class="token boolean">$true</span>

<span class="token comment"># 检查ProtectedFromAccidentalDeletion状态</span>
<span class="token function">Get-ADUser</span> hui<span class="token punctuation">.</span>gao <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> SamAccountName<span class="token punctuation">,</span> ProtectedFromAccidentalDeletion

SamAccountName ProtectedFromAccidentalDeletion
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
Hui<span class="token punctuation">.</span>Gao                                   True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="csv批量创建用户" tabindex="-1"><a class="header-anchor" href="#csv批量创建用户"><span>csv批量创建用户</span></a></h2><p>D:\\MyUsers.csv</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code>EmployeeID<span class="token punctuation">,</span>Description<span class="token punctuation">,</span>GivenName<span class="token punctuation">,</span>Surname<span class="token punctuation">,</span>Department<span class="token punctuation">,</span>Title<span class="token punctuation">,</span>Office<span class="token punctuation">,</span>Manager
100002<span class="token punctuation">,</span>Employee<span class="token punctuation">,</span>Meimei<span class="token punctuation">,</span>Han<span class="token punctuation">,</span>HR Department<span class="token punctuation">,</span>HR Manager<span class="token punctuation">,</span>Beijing<span class="token punctuation">,</span>Hui<span class="token punctuation">.</span>Gao
100003<span class="token punctuation">,</span>Employee<span class="token punctuation">,</span>Tao<span class="token punctuation">,</span>Lin<span class="token punctuation">,</span>Finance Department<span class="token punctuation">,</span>Finance Manager<span class="token punctuation">,</span>Shanghai<span class="token punctuation">,</span>Hui<span class="token punctuation">.</span>Gao
100004<span class="token punctuation">,</span>Intern<span class="token punctuation">,</span>Hua<span class="token punctuation">,</span>Wei<span class="token punctuation">,</span>Finance Department<span class="token punctuation">,</span>Finance Intern<span class="token punctuation">,</span>Shanghai<span class="token punctuation">,</span>Tao<span class="token punctuation">.</span>Lin
100005<span class="token punctuation">,</span>Employee<span class="token punctuation">,</span>Lei<span class="token punctuation">,</span>Li<span class="token punctuation">,</span>IT Department<span class="token punctuation">,</span>IT Manager<span class="token punctuation">,</span>Beijing<span class="token punctuation">,</span>Hui<span class="token punctuation">.</span>Gao
100006<span class="token punctuation">,</span>Contractor<span class="token punctuation">,</span>Jim<span class="token punctuation">,</span>Green<span class="token punctuation">,</span>IT Department<span class="token punctuation">,</span>IT Engineer<span class="token punctuation">,</span>Shanghai<span class="token punctuation">,</span>Lei<span class="token punctuation">.</span>Li
100007<span class="token punctuation">,</span>Contractor<span class="token punctuation">,</span>Lucy<span class="token punctuation">,</span>King<span class="token punctuation">,</span>IT Department<span class="token punctuation">,</span>IT Engineer<span class="token punctuation">,</span>Shenzhen<span class="token punctuation">,</span>Lei<span class="token punctuation">.</span>Li
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token variable">$MyCsv</span> = <span class="token string">&quot;D:\\MyUsers.csv&quot;</span>
<span class="token variable">$MyLines</span> = <span class="token function">Import-Csv</span> <span class="token variable">$MyCsv</span>

 <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$MyLine</span> in <span class="token variable">$MyLines</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token variable">$MyUser</span> = @<span class="token punctuation">{</span>

EmployeeID = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>EmployeeID
Description = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Description
GivenName = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>GivenName
Surname = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Surname
Name = <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>GivenName<span class="token punctuation">)</span></span> <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>Surname<span class="token punctuation">)</span></span>&quot;</span>
DisplayName = <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>GivenName<span class="token punctuation">)</span></span> <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>Surname<span class="token punctuation">)</span></span>&quot;</span>
SamAccountName = <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>GivenName<span class="token punctuation">)</span></span>.<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>Surname<span class="token punctuation">)</span></span>&quot;</span>
UserPrincipalName = <span class="token string">&quot;<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>GivenName<span class="token punctuation">)</span></span>.<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$MyLine</span><span class="token punctuation">.</span>Surname<span class="token punctuation">)</span></span>@minicontoso.com&quot;</span>
Department = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Department
Title = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Title
Office = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Office
Manager = <span class="token variable">$MyLine</span><span class="token punctuation">.</span>Manager
Path = <span class="token string">&quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot;</span>
Enabled = <span class="token boolean">$true</span>
AccountPassword = <span class="token punctuation">(</span><span class="token function">ConvertTo-SecureString</span> <span class="token string">&quot;P@ssW0rD!&quot;</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token function">New-ADUser</span> @MyUser

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>检查用户</p><p>Get-ADUser -SearchBase &quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot; -Filter * -Properties * | Select-Object EmployeeID, Description, DisplayName, SamAccountName, UserPrincipalName, Department, Title, Office, Manager | Format-Table</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> <span class="token operator">-</span>SearchBase <span class="token string">&quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot;</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span> <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> EmployeeID<span class="token punctuation">,</span> Description<span class="token punctuation">,</span> DisplayName<span class="token punctuation">,</span> SamAccountName<span class="token punctuation">,</span> UserPrincipalName<span class="token punctuation">,</span> Department<span class="token punctuation">,</span> Title<span class="token punctuation">,</span> Office<span class="token punctuation">,</span> Manager <span class="token punctuation">|</span> <span class="token function">Format-Table</span>

EmployeeID Description DisplayName SamAccountName UserPrincipalName          Department         Title           Office   Manager                                             
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>          <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>         <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>                                             
100001     Employee    Hui Gao     Hui<span class="token punctuation">.</span>Gao        Hui<span class="token punctuation">.</span>Gao@minicontoso<span class="token punctuation">.</span>com    Executive Team     General Manager Beijing                                                      
100002     Employee    Meimei Han  Meimei<span class="token punctuation">.</span>Han     Meimei<span class="token punctuation">.</span>Han@minicontoso<span class="token punctuation">.</span>com HR Department      HR Manager      Beijing  CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
100003     Employee    Tao Lin     Tao<span class="token punctuation">.</span>Lin        Tao<span class="token punctuation">.</span>Lin@minicontoso<span class="token punctuation">.</span>com    Finance Department Finance Manager Shanghai CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
100004     Intern      Hua Wei     Hua<span class="token punctuation">.</span>Wei        Hua<span class="token punctuation">.</span>Wei@minicontoso<span class="token punctuation">.</span>com    Finance Department Finance Intern  Shanghai CN=Tao Lin<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
100005     Employee    Lei Li      Lei<span class="token punctuation">.</span>Li         Lei<span class="token punctuation">.</span>Li@minicontoso<span class="token punctuation">.</span>com     IT Department      IT Manager      Beijing  CN=Hui Gao<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com
100006     Contractor  Jim Green   Jim<span class="token punctuation">.</span>Green      Jim<span class="token punctuation">.</span>Green@minicontoso<span class="token punctuation">.</span>com  IT Department      IT Engineer     Shanghai CN=Lei Li<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com 
100007     Contractor  Lucy King   Lucy<span class="token punctuation">.</span>King      Lucy<span class="token punctuation">.</span>King@minicontoso<span class="token punctuation">.</span>com  IT Department      IT Engineer     Shenzhen CN=Lei Li<span class="token punctuation">,</span>OU=CorpUser<span class="token punctuation">,</span>OU=ROOT<span class="token punctuation">,</span>DC=minicontoso<span class="token punctuation">,</span>DC=com 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>自定义属性</p><div class="language-powershell line-numbers-mode" data-ext="powershell" data-title="powershell"><pre class="language-powershell"><code><span class="token function">Get-ADUser</span> <span class="token operator">-</span>SearchBase <span class="token string">&quot;OU=CorpUser,OU=ROOT,DC=minicontoso,DC=com&quot;</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span> <span class="token operator">-</span>Properties <span class="token operator">*</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> EmployeeID<span class="token punctuation">,</span> Description<span class="token punctuation">,</span> DisplayName<span class="token punctuation">,</span> SamAccountName<span class="token punctuation">,</span> UserPrincipalName<span class="token punctuation">,</span> Department<span class="token punctuation">,</span> Title<span class="token punctuation">,</span> Office<span class="token punctuation">,</span> @<span class="token punctuation">{</span>Name=<span class="token string">&#39;Manager&#39;</span><span class="token punctuation">;</span>Expression=<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>Manager<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Format-Table</span>

EmployeeID Description DisplayName SamAccountName UserPrincipalName          Department         Title           Office   Manager
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>          <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>         <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
100001     Employee    Hui Gao     Hui<span class="token punctuation">.</span>Gao        Hui<span class="token punctuation">.</span>Gao@minicontoso<span class="token punctuation">.</span>com    Executive Team     General Manager Beijing         
100002     Employee    Meimei Han  Meimei<span class="token punctuation">.</span>Han     Meimei<span class="token punctuation">.</span>Han@minicontoso<span class="token punctuation">.</span>com HR Department      HR Manager      Beijing  Hui Gao
100003     Employee    Tao Lin     Tao<span class="token punctuation">.</span>Lin        Tao<span class="token punctuation">.</span>Lin@minicontoso<span class="token punctuation">.</span>com    Finance Department Finance Manager Shanghai Hui Gao
100004     Intern      Hua Wei     Hua<span class="token punctuation">.</span>Wei        Hua<span class="token punctuation">.</span>Wei@minicontoso<span class="token punctuation">.</span>com    Finance Department Finance Intern  Shanghai Tao Lin
100005     Employee    Lei Li      Lei<span class="token punctuation">.</span>Li         Lei<span class="token punctuation">.</span>Li@minicontoso<span class="token punctuation">.</span>com     IT Department      IT Manager      Beijing  Hui Gao
100006     Contractor  Jim Green   Jim<span class="token punctuation">.</span>Green      Jim<span class="token punctuation">.</span>Green@minicontoso<span class="token punctuation">.</span>com  IT Department      IT Engineer     Shanghai Lei Li 
100007     Contractor  Lucy King   Lucy<span class="token punctuation">.</span>King      Lucy<span class="token punctuation">.</span>King@minicontoso<span class="token punctuation">.</span>com  IT Department      IT Engineer     Shenzhen Lei Li 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,40),p=[o];function i(c,l){return s(),a("div",null,p)}const k=n(t,[["render",i],["__file","user.html.vue"]]),d=JSON.parse('{"path":"/adds/user.html","title":"用户管理","lang":"zh-CN","frontmatter":{"title":"用户管理","icon":"user","order":4,"category":["活动目录"],"tag":["活动目录","用户管理"],"description":"组织单元 创建组织单元OU New-ADOrganizationalUnit -Name \\"ROOT\\" -Path \\"DC=MINICONTOSO,DC=COM\\" 查询OU ProtectedFromAccidentalDeletion 默认情况下，该设置是True，也就是防止被误删除。 创建子OU 查询子OU Get-ADOrganizational...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/windows/adds/user.html"}],["meta",{"property":"og:site_name","content":"minicontoso"}],["meta",{"property":"og:title","content":"用户管理"}],["meta",{"property":"og:description","content":"组织单元 创建组织单元OU New-ADOrganizationalUnit -Name \\"ROOT\\" -Path \\"DC=MINICONTOSO,DC=COM\\" 查询OU ProtectedFromAccidentalDeletion 默认情况下，该设置是True，也就是防止被误删除。 创建子OU 查询子OU Get-ADOrganizational..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"Echo"}],["meta",{"property":"article:tag","content":"活动目录"}],["meta",{"property":"article:tag","content":"用户管理"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"用户管理\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Echo\\",\\"url\\":\\"https://www.minicontoso.com\\"}]}"]]},"headers":[{"level":2,"title":"组织单元","slug":"组织单元","link":"#组织单元","children":[]},{"level":2,"title":"创建用户方式一","slug":"创建用户方式一","link":"#创建用户方式一","children":[]},{"level":2,"title":"创建用户方式二","slug":"创建用户方式二","link":"#创建用户方式二","children":[]},{"level":2,"title":"查询用户","slug":"查询用户","link":"#查询用户","children":[]},{"level":2,"title":"防止误删除功能","slug":"防止误删除功能","link":"#防止误删除功能","children":[]},{"level":2,"title":"csv批量创建用户","slug":"csv批量创建用户","link":"#csv批量创建用户","children":[]}],"git":{},"readingTime":{"minutes":4.01,"words":1204},"filePathRelative":"adds/user.md","autoDesc":true}');export{k as comp,d as data};
